<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Adicionar Materiais</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='professor.css') }}" />
  <link rel="stylesheet" href="{{ url_for('static', filename='adicionar_materiais.css') }}" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  
</head>
<body class="page-materiais">

<header>
  <a href="{{ url_for('index_professor') }}" class="logo-link">
    <div class="logo">
      <img src="static/img/Logo.png" alt="Logo EduQuiz" />
      <span class="logo-text">EDUQUIZ</span>
    </div>
  </a>


  <nav>
  <a href="{{ url_for('index_professor') }}" class="home-icon">
    <i class="bi bi-house" style="font-size:30px; color:white;"></i>
  </a>
    </nav>

</header>

<main>
  <h1>Adicionar Materiais</h1>

  <form action="{{ url_for('adicionar_materiais') }}" method="POST" enctype="multipart/form-data">
    <input type="text" name="titulo" placeholder="T√≠tulo do material" required />
    
    <select name="materia" required>
      <option disabled selected>Selecione a mat√©ria</option>
      <option value="N√∫meros e Opera√ß√µes">N√∫meros e Opera√ß√µes</option>
      <option value="Geometria e Medidas">Geometria e Medidas</option>
      <option value="Estat√≠stica e Probabilidade">Estat√≠stica e Probabilidade</option>
      <option value="√Ålgebra e Fun√ß√µes">√Ålgebra e Fun√ß√µes</option>
      <option value="Matem√°tica Financeira e Aplicada">Matem√°tica Financeira e Aplicada</option>
    </select>

    <textarea name="descricao" placeholder="Descri√ß√£o do material..." rows="4" required></textarea>

    <div class="custom-file-input">
      <label for="arquivo">üìÅ Escolher arquivo</label>
      <input type="file" id="arquivo" name="arquivo" accept=".pdf,.doc,.docx,.ppt,.pptx,.png,.jpg,.jpeg" required />
      <span id="file-chosen">Nenhum arquivo selecionado</span>
    </div>

    <div class="botoes-formulario">
      <button type="submit" class="btn-concluir">Adicionar</button>
    </div>
  </form>

  <section class="material-card">
    <h2>Materiais j√° adicionados</h2>
    {% for material in materiais %}
      <div class="card-material">
        <h3>{{ material[1] }}</h3>
        <p><strong>Mat√©ria:</strong> {{ material[2] }}</p>
        <p>{{ material[3] }}</p>
        <p><strong>Professor:</strong> {{ material[6] }}</p>
        <p><strong>Publicado em:</strong> {{ material[7].strftime('%d/%m/%Y %H:%M') }}</p>
        <a href="{{ url_for('baixar_material', material_id=material[0]) }}">üìé Ver material</a>

        {% if material[5] == session['usuario_id'] %}
          <div class="botoes-acoes">     
            <form action="{{ url_for('excluir_material', material_id=material[0]) }}" method="POST">
              <button type="button" class="editar" onclick="mostrarFormulario({{ material[0] }})">Editar</button>
              <button type="submit" class="excluir">Excluir Material</button>
            </form>
          </div>

          <form id="form-editar-{{ material[0] }}" class="form-editar" action="{{ url_for('editar_material', material_id=material[0]) }}" method="POST" style="display: none;">
            <input type="text" name="novo_titulo" value="{{ material[1] }}" required />
            <input type="text" name="nova_descricao" value="{{ material[3] }}" required />

            <div class="botoes-acoes">
              <button type="submit" class="salvar">Salvar</button>
              <button type="button" class="cancelar" onclick="esconderFormulario({{ material[0] }})">Cancelar</button>
            </div>
          </form>
        {% endif %}
      </div>
    {% else %}
      <p>Nenhum material adicionado ainda.</p>
    {% endfor %}
  </section>
</main>

<script>
function mostrarFormulario(id) {
  document.getElementById(`form-editar-${id}`).style.display = 'block';
}

function esconderFormulario(id) {
  document.getElementById(`form-editar-${id}`).style.display = 'none';
}

document.getElementById("arquivo").addEventListener("change", function () {
  const fileName = this.files[0] ? this.files[0].name : "Nenhum arquivo selecionado";
  document.getElementById("file-chosen").textContent = fileName;
});
</script>

</body>
</html>
