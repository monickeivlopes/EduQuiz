<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Materiais de Estudo</title>
  <link rel="stylesheet" href="/static/materiais.css">
</head>
<body>

<header>
  <div class="logo">
    <img src="static/img/Logo.png" alt="Logo EduQuiz" />
    <span>EDUQUIZ</span>
  </div>
  <nav>
    <a href="{{ url_for('index_aluno') }}">
      <img src="static/img/casa.png" alt="√çcone de home" />
    </a>
  </nav>
</header>

<main>
  <h1>Materiais de Estudo</h1>
  <h2>Materiais Dispon√≠veis</h2>

  <!-- Formul√°rio de Filtro -->
  <form method="get" class="filtro-form">
    <div>
      <label for="assunto">Mat√©ria:</label>
      <select id="assunto" name="assunto">
        <option value="todos" {% if assunto_filtro == 'todos' %}selected{% endif %}>Todas as mat√©rias</option>
        <option value="N√∫meros e Opera√ß√µes" {% if assunto_filtro == 'N√∫meros e Opera√ß√µes' %}selected{% endif %}>N√∫meros e Opera√ß√µes</option>
        <option value="Geometria e Medidas" {% if assunto_filtro == 'Geometria e Medidas' %}selected{% endif %}>Geometria e Medidas</option>
        <option value="Estat√≠stica e Probabilidade" {% if assunto_filtro == 'Estat√≠stica e Probabilidade' %}selected{% endif %}>Estat√≠stica e Probabilidade</option>
        <option value="√Ålgebra e Fun√ß√µes" {% if assunto_filtro == '√Ålgebra e Fun√ß√µes' %}selected{% endif %}>√Ålgebra e Fun√ß√µes</option>
        <option value="Matem√°tica Financeira e Aplicada" {% if assunto_filtro == 'Matem√°tica Financeira e Aplicada' %}selected{% endif %}>Matem√°tica Financeira e Aplicada</option>
      </select>
    </div>

    <div>
      <label for="data">Data:</label>
      <input type="date" id="data" name="data" value="{{ data_filtro or '' }}">
    </div>

    <div>
      <label for="ordem">Ordenar por:</label>
      <select id="ordem" name="ordem">
        <option value="desc" {% if ordem == 'desc' %}selected{% endif %}>Mais recentes</option>
        <option value="asc" {% if ordem == 'asc' %}selected{% endif %}>Mais antigos</option>
      </select>
    </div>

    <div>
      <button type="submit">Aplicar Filtros</button>
      <a href="{{ url_for('materiais') }}" class="btn-limpar">Limpar</a>
    </div>
  </form>

  <!-- Contador de materiais -->
  <div class="contador-materiais">
    {% if materiais %}
      {{ materiais|length }} material(is) encontrado(s)
    {% else %}
      Nenhum material encontrado
    {% endif %}
  </div>

  <!-- Lista de materiais -->
  {% for m in materiais %}
    <div class="card-material">
      {% set materia_slug = m[2]|lower|replace(' ', '-')|replace('√°', 'a')|replace('√©', 'e')|replace('√≠', 'i')|replace('√≥', 'o')|replace('√∫', 'u')|replace('√£', 'a')|replace('√µ', 'o')|replace('√ß', 'c') %}
      <span class="materia-badge badge-{{ materia_slug }}">{{ m[2] }}</span>
      <h3>{{ m[1] }}</h3>
      <p>{{ m[3] }}</p>
      <p><strong>Professor:</strong> {{ m[5] }}</p>
      <p><strong>Publicado em:</strong> {{ m[6] }}</p>
      <a href="{{ url_for('baixar_material', material_id=m[0]) }}">üì• Baixar Material</a>
    </div>
  {% else %}
    <div class="sem-materiais">
      <p style="font-size: 1.2rem;">Nenhum material encontrado para os filtros selecionados.</p>
      <p style="color: #999;">Tente ajustar os filtros ou verifique se h√° materiais dispon√≠veis.</p>
    </div>
  {% endfor %}
</main>

</body>
</html>